<!doctype html>
<head>
<title>Space Battle</title>
<script src="../src/input.js"></script>
<script src="../src/vector.js"></script>
<script src="../src/priorityqueue.js"></script>
<script src="../src/observable.js"></script>
<script src="../src/collision.js"></script>
<script src="../src/physics.js"></script>
<script src="../src/RenderObject.js"></script>
<script src="../src/game.js"></script>
<script>
    function createBall(physicsSystem) {
        const size = Math.random() * 3 + 1;
        const ball = {
                renderObject: createRenderObject("randomColouredBall", size),
                physicsObject: new PhysicsModel(physicsSystem, size, size * 4, {x: Math.random() * 100, y: Math.random() * 100})
            };

        ball.physicsObject.addExternalForce(vector2dFromAngle(Math.random() * 360, size * 4 * 8), 1);
        physicsSystem.add(ball.physicsObject);

        return ball;
    }

    function createPlanet(physicsSystem) {
        const size = 5;
        const planet = {
                renderObject: createRenderObject("randomColouredBall", size),
                physicsObject: new PhysicsModel(physicsSystem, size, 1000, {x: 50, y: 50})
            };

        planet.physicsObject.addExternalForce(vector2dFromAngle(Math.random() * 360, size * 4 * 4), 1);
        physicsSystem.add(planet.physicsObject);

        return planet;
    }

    class BallGame extends Game {
        constructor() {
            super();

            this.balls = [];

            for (let i = 0; i < 15; i++) {
                this.balls.push(createBall(this.physicsSystem));
            }

            this.balls.push(createPlanet(this.physicsSystem));
        }
    
        update(time) {
            this.physicsSystem.update(this.physicsFrameTime);
        }

        render(interoplate) {
            for (let ball of this.balls) {
                ball.renderObject.rotate(ball.physicsObject.rotateAngle);
                ball.renderObject.moveTo(ball.physicsObject.position.x, ball.physicsObject.position.y);
            }
        }
    }

    window.onload = function() {
        const game = new BallGame();
        game.run();
    }
</script>
<style>
body {background: #042029;}
svg {
	display: block;
	height: 95vh;
	margin-left: auto;
	margin-right: auto;
	border: #CCC 1px solid;
}
</style>
</head>
<body>
<svg id='render' viewBox="0 0 100 100">
<g transform='translate(0,100)scale(1,-1) ' id="gameobjects">
</g>
</svg>
</body>
</html>
